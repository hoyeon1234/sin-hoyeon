<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Hoyeon's Blog – dl-12-01</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-JE4129QJZV"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-JE4129QJZV', { 'anonymize_ip': true});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Hoyeon’s Blog</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About me</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/hoyeon1234/sin-hoyeon/tree/main/posts"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">



<section id="똑같은-코드들" class="level1">
<h1>똑같은 코드들</h1>
<section id="data-hihello" class="level2">
<h2 class="anchored" data-anchor-id="data-hihello">data: hi?hello!!</h2>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">def</span> f(txt,mapping):</span>
<span id="cb1-2"><a href="#cb1-2"></a>    <span class="cf">return</span> [mapping[<span class="bu">chr</span>] <span class="cf">for</span> <span class="bu">chr</span> <span class="kw">in</span> txt]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a><span class="im">import</span> torch</span>
<span id="cb2-2"><a href="#cb2-2"></a>txt <span class="op">=</span> <span class="bu">list</span>(<span class="st">"hi?hello!!"</span>) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb2-3"><a href="#cb2-3"></a>txt_x <span class="op">=</span> txt[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb2-4"><a href="#cb2-4"></a>txt_y <span class="op">=</span> txt[<span class="dv">1</span>:]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a>mapping <span class="op">=</span> {<span class="st">"!"</span> : <span class="dv">0</span> ,<span class="st">"?"</span> : <span class="dv">1</span>,<span class="st">"h"</span> : <span class="dv">2</span>, <span class="st">"i"</span> : <span class="dv">3</span>,<span class="st">"e"</span> : <span class="dv">4</span>,<span class="st">"l"</span> : <span class="dv">5</span>, <span class="st">"o"</span> : <span class="dv">6</span>}</span>
<span id="cb3-2"><a href="#cb3-2"></a>x <span class="op">=</span> torch.nn.functional.one_hot(torch.tensor(f(txt_x,mapping))).<span class="bu">float</span>().to(<span class="st">"cuda:0"</span>)</span>
<span id="cb3-3"><a href="#cb3-3"></a>y <span class="op">=</span> torch.nn.functional.one_hot(torch.tensor(f(txt_y,mapping))).<span class="bu">float</span>().to(<span class="st">"cuda:0"</span>)</span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="bu">print</span>(<span class="bu">len</span>(mapping))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>7</code></pre>
</div>
</div>
</section>
<section id="초깃값-h_0c_0는-생략이-가능하다." class="level2">
<h2 class="anchored" data-anchor-id="초깃값-h_0c_0는-생략이-가능하다.">초깃값 h_0,c_0는 생략이 가능하다.</h2>
<p><code>-</code> 코드1 : 정석코드</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a>torch.manual_seed(<span class="dv">43052</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a>lstm <span class="op">=</span> torch.nn.LSTM(<span class="dv">7</span>,<span class="dv">4</span>).to(<span class="st">"cuda:0"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a>_h0 <span class="op">=</span> _c0 <span class="op">=</span> torch.zeros(<span class="dv">1</span>,<span class="dv">4</span>).to(<span class="st">"cuda:0"</span>)</span>
<span id="cb6-2"><a href="#cb6-2"></a>lstm(x,(_h0,_c0))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>(tensor([[-0.1547,  0.0673,  0.0695,  0.1563],
         [-0.0786, -0.1430, -0.0250,  0.1189],
         [-0.0300, -0.2256, -0.1324,  0.1439],
         ...,
         [-0.0723,  0.0620,  0.1913,  0.2015],
         [-0.1155,  0.0746,  0.1747,  0.2938],
         [-0.2350, -0.1559, -0.1093,  0.2682]], device='cuda:0',
        grad_fn=&lt;SqueezeBackward1&gt;),
 (tensor([[-0.2350, -0.1559, -0.1093,  0.2682]], device='cuda:0',
         grad_fn=&lt;SqueezeBackward1&gt;),
  tensor([[-0.4451, -0.2456, -0.1900,  0.6232]], device='cuda:0',
         grad_fn=&lt;SqueezeBackward1&gt;)))</code></pre>
</div>
</div>
<p><code>-</code> 코드2 : 초깃값이 없는 코드(c0,h0는 사실 없어도 무방함) <code>-</code> 알아서 차원맞춰서 잘 초기화 해줘요.</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a>torch.manual_seed(<span class="dv">43052</span>)</span>
<span id="cb8-2"><a href="#cb8-2"></a>lstm <span class="op">=</span> torch.nn.LSTM(<span class="dv">7</span>,<span class="dv">4</span>).to(<span class="st">"cuda:0"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a>lstm(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>(tensor([[-0.1547,  0.0673,  0.0695,  0.1563],
         [-0.0786, -0.1430, -0.0250,  0.1189],
         [-0.0300, -0.2256, -0.1324,  0.1439],
         ...,
         [-0.0723,  0.0620,  0.1913,  0.2015],
         [-0.1155,  0.0746,  0.1747,  0.2938],
         [-0.2350, -0.1559, -0.1093,  0.2682]], device='cuda:0',
        grad_fn=&lt;SqueezeBackward1&gt;),
 (tensor([[-0.2350, -0.1559, -0.1093,  0.2682]], device='cuda:0',
         grad_fn=&lt;SqueezeBackward1&gt;),
  tensor([[-0.4451, -0.2456, -0.1900,  0.6232]], device='cuda:0',
         grad_fn=&lt;SqueezeBackward1&gt;)))</code></pre>
</div>
</div>
</section>
<section id="세트2-x.shape-lh_in-or-lnh_in" class="level2">
<h2 class="anchored" data-anchor-id="세트2-x.shape-lh_in-or-lnh_in">세트2: x.shape = (<span class="math inline">\(L\)</span>,<span class="math inline">\(H_{in}\)</span>) or (<span class="math inline">\(L\)</span>,<span class="math inline">\(N\)</span>,<span class="math inline">\(H_{in}\)</span>)</h2>
<p><code>-</code> timeseiries와 RNN<br> timeseries 데이터는 시점(timestep)에 따라서 그 값들이 정렬된 데이터입니다. 각 시점에서의 값들은 서로 연관되어 있습니다. 하나의 timeseries 데이터를 RNN계열의 모형에 입력하면 각 시점에서 값을 재귀적으로 읽어서 <span class="math inline">\(\hat{y}\)</span>를 출력합니다. <code>-</code> 파라미터 설명<br> - <span class="math inline">\(L\)</span> : sequnce length = timestep(시점)의 총 갯수 = timestp의 길이 = 시계열 데이터의 길이 - <span class="math inline">\(H_{in}\)</span> : each timestep(시점)에 들어오는 입력백터의 길이, 입력시계열이 시점별로 몇개의 변수로 나타내어 지는가?,만약에 원핫인코딩으로 정리하면 단어수를 의미함,시점마다 길이는 모두 같음(전처리 과정에서 길이를 같게해주기 때문) - <span class="math inline">\(N\)</span> : 전체 데이터를 몇개의 시계열(묶음)데이터 인지? = 전체데이터 안에 있는 시계열데이터 묶음의 갯수 = 전체데이터의 미니배치의 갯수, 예를들어 (1000,7)의 shape을 가진 시계열데이터를 2개의 묶음으로 나눈다면 N = batch size = 2,왜 쪼개는지는 나중에 … 공부</p>
<p><code>-</code> 코드3 : x의 차원은 사실 엄밀하게는 (<span class="math inline">\(L\)</span>,<span class="math inline">\(N\)</span>,<span class="math inline">\(H_{in}\)</span>)이다.</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a>torch.manual_seed(<span class="dv">43052</span>)</span>
<span id="cb11-2"><a href="#cb11-2"></a>lstm <span class="op">=</span> torch.nn.LSTM(<span class="dv">7</span>,<span class="dv">4</span>).to(<span class="st">"cuda"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a>lstm(x.reshape(<span class="dv">999</span>,<span class="dv">1</span>,<span class="dv">7</span>)) <span class="co">#전체데이터를 쪼개지 않았으므로 즉 묶음은 1개뿐이므로 N = 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>(tensor([[[-0.1547,  0.0673,  0.0695,  0.1563]],
 
         [[-0.0786, -0.1430, -0.0250,  0.1189]],
 
         [[-0.0300, -0.2256, -0.1324,  0.1439]],
 
         ...,
 
         [[-0.0723,  0.0620,  0.1913,  0.2015]],
 
         [[-0.1155,  0.0746,  0.1747,  0.2938]],
 
         [[-0.2350, -0.1559, -0.1093,  0.2682]]], device='cuda:0',
        grad_fn=&lt;CudnnRnnBackward0&gt;),
 (tensor([[[-0.2350, -0.1559, -0.1093,  0.2682]]], device='cuda:0',
         grad_fn=&lt;CudnnRnnBackward0&gt;),
  tensor([[[-0.4451, -0.2456, -0.1900,  0.6232]]], device='cuda:0',
         grad_fn=&lt;CudnnRnnBackward0&gt;)))</code></pre>
</div>
</div>
<p><code>-</code> 코드4 : <code>batch_first = True</code>일 경우 차원은 (<span class="math inline">\(N\)</span>,<span class="math inline">\(L\)</span>,<span class="math inline">\(H_{in}\)</span>)이다.</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a>torch.manual_seed(<span class="dv">43052</span>)</span>
<span id="cb14-2"><a href="#cb14-2"></a>lstm <span class="op">=</span> torch.nn.LSTM(<span class="dv">7</span>,<span class="dv">4</span>,batch_first <span class="op">=</span> <span class="va">True</span>).to(<span class="st">"cuda"</span>)</span>
<span id="cb14-3"><a href="#cb14-3"></a>lstm(x.reshape(<span class="dv">1</span>,<span class="dv">999</span>,<span class="dv">7</span>)) <span class="co">#전체데이터를 쪼개지 않았으므로 즉 묶음은 1개뿐이므로 N = 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>(tensor([[[-0.1547,  0.0673,  0.0695,  0.1563],
          [-0.0786, -0.1430, -0.0250,  0.1189],
          [-0.0300, -0.2256, -0.1324,  0.1439],
          ...,
          [-0.0723,  0.0620,  0.1913,  0.2015],
          [-0.1155,  0.0746,  0.1747,  0.2938],
          [-0.2350, -0.1559, -0.1093,  0.2682]]], device='cuda:0',
        grad_fn=&lt;CudnnRnnBackward0&gt;),
 (tensor([[[-0.2350, -0.1559, -0.1093,  0.2682]]], device='cuda:0',
         grad_fn=&lt;CudnnRnnBackward0&gt;),
  tensor([[[-0.4451, -0.2456, -0.1900,  0.6232]]], device='cuda:0',
         grad_fn=&lt;CudnnRnnBackward0&gt;)))</code></pre>
</div>
</div>
</section>
<section id="세트3-hidden.shape-d-times-num_layersh_out-or-d-timesnum_layersnh_out" class="level2">
<h2 class="anchored" data-anchor-id="세트3-hidden.shape-d-times-num_layersh_out-or-d-timesnum_layersnh_out">세트3 : hidden.shape = (<span class="math inline">\(D \times\)</span> <code>num_layers</code>,<span class="math inline">\(H_{out}\)</span>) or (<span class="math inline">\(D \times\)</span><code>num_layers</code>,<span class="math inline">\(N\)</span>,<span class="math inline">\(H_{out}\)</span>)</h2>
<p>네트워크에 우리는 h_0,c_0를 넣었었다.그때 h_0.shape = c_0.shape = (1,<span class="math inline">\(H_{out}\)</span>)이었는데 여기서 사실은 1은 <span class="math inline">\(D \times `num_layers`\)</span>입니다. 우리는 1개의 히든레이어를 가진 LSTM이므로 <code>num_layers</code>= 1 따라서 1이었습니다.<br></p>
<p><code>-</code>파라미터 설명<br> - <span class="math inline">\(D\)</span> = 2 if bidirectional = True otherwise = 1 (양방향이면2 단방향이면1,우리는 단방향만 써왔으므로 <span class="math inline">\(D\)</span> = 1) - <code>num_layers</code> = 히든레이어가 1개 이상인 경우(중첩된 RNN) - <span class="math inline">\(H_{out}\)</span> = 히든노드의 수 - <span class="math inline">\(N\)</span> : 전체시계열 데이터안에 있는 묶음의 갯수 = 전체데이터 안에 있는 시계열데이터 묶음의 갯수 = 전체데이터의 미니배치의 갯수, 미니배치안에 있는 원소들의 갯수가 아님 !! 예를들어 (1000,7)의 shape을 가진 시계열데이터를 2개의 묶음으로 나눈다면 N = batch size = 2,왜 쪼개는지는 나중에 … 공부</p>
<p><code>-</code>코드5<br> <code>-</code> x.shape = $(1,H_{in}) $ x.shape = <span class="math inline">\((L,1,H_{in})\)</span><br> <code>-</code> h.shape = $(1,H_{out}) $ h.shape = <span class="math inline">\((1,1,H_{out})\)</span></p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1"></a>torch.manual_seed(<span class="dv">43052</span>)</span>
<span id="cb16-2"><a href="#cb16-2"></a>lstm <span class="op">=</span> torch.nn.LSTM(<span class="dv">7</span>,<span class="dv">4</span>).to(<span class="st">"cuda:0"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1"></a><span class="co">#엄밀한 방식</span></span>
<span id="cb17-2"><a href="#cb17-2"></a>_h0,_c0 <span class="op">=</span> torch.zeros(<span class="dv">1</span>,<span class="dv">4</span>).to(<span class="st">"cuda:0"</span>),torch.zeros(<span class="dv">1</span>,<span class="dv">4</span>).to(<span class="st">"cuda:0"</span>)</span>
<span id="cb17-3"><a href="#cb17-3"></a>lstm(x.reshape(<span class="dv">999</span>,<span class="dv">1</span>,<span class="dv">7</span>),(_h0.reshape(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">4</span>),_c0.reshape(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">4</span>)))</span>
<span id="cb17-4"><a href="#cb17-4"></a></span>
<span id="cb17-5"><a href="#cb17-5"></a><span class="co">#엄밀한 방식2</span></span>
<span id="cb17-6"><a href="#cb17-6"></a>_h0 <span class="op">=</span> _c0 <span class="op">=</span> torch.zeros(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">4</span>).to(<span class="st">"cuda:0"</span>)</span>
<span id="cb17-7"><a href="#cb17-7"></a>lstm(x.reshape(<span class="dv">999</span>,<span class="dv">1</span>,<span class="dv">7</span>),(_h0,_c0))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>(tensor([[[-0.1547,  0.0673,  0.0695,  0.1563]],
 
         [[-0.0786, -0.1430, -0.0250,  0.1189]],
 
         [[-0.0300, -0.2256, -0.1324,  0.1439]],
 
         ...,
 
         [[-0.0723,  0.0620,  0.1913,  0.2015]],
 
         [[-0.1155,  0.0746,  0.1747,  0.2938]],
 
         [[-0.2350, -0.1559, -0.1093,  0.2682]]], device='cuda:0',
        grad_fn=&lt;CudnnRnnBackward0&gt;),
 (tensor([[[-0.2350, -0.1559, -0.1093,  0.2682]]], device='cuda:0',
         grad_fn=&lt;CudnnRnnBackward0&gt;),
  tensor([[[-0.4451, -0.2456, -0.1900,  0.6232]]], device='cuda:0',
         grad_fn=&lt;CudnnRnnBackward0&gt;)))</code></pre>
</div>
</div>
<p><code>-</code> 사실 _h0.shape= _c0.shape = (<span class="math inline">\(1,H_{out}\)</span>)에서 1은 <span class="math inline">\(D \times\)</span> <code>numlayers</code>입니다.<br> - 만약 은닉계층의 수가 1개인 lstm이라면 _h0.shape = _c0.shape = <span class="math inline">\((1,H_{out})\)</span> - 만약 은닉계층의 수는 1개,양방향 lstm이라면 _h0.shape = _c0.shape = <span class="math inline">\((2,H_{out})\)</span> - 만약 은닉계층의 수가 3개인 (단방향)lstm이라면 _h0.shape = _c0.shape = <span class="math inline">\((3,H_{out})\)</span> - 만약 은닉계층의 수가 3개,양방향 lstm이라면 _h0.shape = _c0.shape = <span class="math inline">\((6,H_{out})\)</span></p>
</section>
</section>
<section id="똑같은-코드들-torch.nn.lstm_cell" class="level1">
<h1>똑같은 코드들 torch.nn.lstm_cell</h1>
<p><code>-</code> 코드1 : 정석코드</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1"></a>torch.manual_seed(<span class="dv">43052</span>)</span>
<span id="cb19-2"><a href="#cb19-2"></a>lstmcell <span class="op">=</span> torch.nn.LSTMCell(<span class="dv">7</span>,<span class="dv">4</span>).to(<span class="st">"cuda:0"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1"></a>xt <span class="op">=</span> x[[<span class="dv">1</span>]] <span class="co">#임의의 t시점(여기서는 t=1)에서의 데이터를 받고</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>_h0,_c0 <span class="op">=</span> torch.zeros(<span class="dv">1</span>,<span class="dv">4</span>).to(<span class="st">"cuda:0"</span>),torch.zeros(<span class="dv">1</span>,<span class="dv">4</span>).to(<span class="st">"cuda:0"</span>)<span class="co">#초기 h0,c0를 만들고</span></span>
<span id="cb20-3"><a href="#cb20-3"></a>xt.shape,_h0.shape,_c0.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>(torch.Size([1, 7]), torch.Size([1, 4]), torch.Size([1, 4]))</code></pre>
</div>
</div>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1"></a>lstmcell(xt,(_h0,_c0)) <span class="co">#임의의 시점에서의 값,초깃값들을 넣어줌</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>(tensor([[-0.0290, -0.1758, -0.0537,  0.0598]], device='cuda:0',
        grad_fn=&lt;ThnnFusedLstmCellBackward0&gt;),
 tensor([[-0.0582, -0.4566, -0.1256,  0.1922]], device='cuda:0',
        grad_fn=&lt;ThnnFusedLstmCellBackward0&gt;))</code></pre>
</div>
</div>
<p><code>-</code> 코드2 : 초깃값 생략 코드</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1"></a>torch.manual_seed(<span class="dv">43052</span>)</span>
<span id="cb24-2"><a href="#cb24-2"></a>lstmcell <span class="op">=</span> torch.nn.LSTMCell(<span class="dv">7</span>,<span class="dv">4</span>).to(<span class="st">"cuda:0"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1"></a>xt <span class="op">=</span> x[[<span class="dv">1</span>]] <span class="co">#임의의 t시점(여기서는 t=1)에서의 데이터를 받고</span></span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="co">#_h0,_c0 = torch.zeros(1,4).to("cuda:0"),torch.zeros(1,4).to("cuda:0")#초기 h0,c0를 만들고</span></span>
<span id="cb25-3"><a href="#cb25-3"></a>xt.shape<span class="co">#,_h0.shape,_c0.shape</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>torch.Size([1, 7])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1"></a>lstmcell(xt) <span class="co">#임의의 시점에서의 값만 넣어줌</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>(tensor([[-0.0290, -0.1758, -0.0537,  0.0598]], device='cuda:0',
        grad_fn=&lt;ThnnFusedLstmCellBackward0&gt;),
 tensor([[-0.0582, -0.4566, -0.1256,  0.1922]], device='cuda:0',
        grad_fn=&lt;ThnnFusedLstmCellBackward0&gt;))</code></pre>
</div>
</div>
<section id="세트2-xt.shape-nh_in-or-h_in" class="level2">
<h2 class="anchored" data-anchor-id="세트2-xt.shape-nh_in-or-h_in">세트2 : xt.shape = <span class="math inline">\((N,H_{in}) or (H_{in})\)</span></h2>
<p><code>-</code>코드2:초깃값 생략</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1"></a>torch.manual_seed(<span class="dv">43052</span>)</span>
<span id="cb29-2"><a href="#cb29-2"></a>lstmcell <span class="op">=</span> torch.nn.LSTMCell(<span class="dv">7</span>,<span class="dv">4</span>).to(<span class="st">"cuda"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1"></a>xt <span class="op">=</span> x[[<span class="dv">1</span>]]</span>
<span id="cb30-2"><a href="#cb30-2"></a>xt.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>torch.Size([1, 7])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1"></a>lstmcell(xt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>(tensor([[-0.0290, -0.1758, -0.0537,  0.0598]], device='cuda:0',
        grad_fn=&lt;ThnnFusedLstmCellBackward0&gt;),
 tensor([[-0.0582, -0.4566, -0.1256,  0.1922]], device='cuda:0',
        grad_fn=&lt;ThnnFusedLstmCellBackward0&gt;))</code></pre>
</div>
</div>
<p>-코드3:간단한 shape 사용</p>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1"></a>torch.manual_seed(<span class="dv">43052</span>)</span>
<span id="cb34-2"><a href="#cb34-2"></a>lstmcell <span class="op">=</span> torch.nn.LSTMCell(<span class="dv">7</span>,<span class="dv">4</span>).to(<span class="st">"cuda:0"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1"></a>xt <span class="op">=</span> x[<span class="dv">1</span>]</span>
<span id="cb35-2"><a href="#cb35-2"></a>xt.shape <span class="co">#위의 shape과 다른것을 확인</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>torch.Size([7])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1"></a>lstmcell(xt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>(tensor([-0.0290, -0.1758, -0.0537,  0.0598], device='cuda:0',
        grad_fn=&lt;SqueezeBackward1&gt;),
 tensor([-0.0582, -0.4566, -0.1256,  0.1922], device='cuda:0',
        grad_fn=&lt;SqueezeBackward1&gt;))</code></pre>
</div>
</div>
</section>
<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section"></h2>
</section>
<section id="세트3-hidden.shape-nh_out-or-h_out" class="level2">
<h2 class="anchored" data-anchor-id="세트3-hidden.shape-nh_out-or-h_out">세트3 : hidden.shape = <span class="math inline">\((N,H_{out})\)</span> or <span class="math inline">\((H_{out})\)</span></h2>
<p><code>-</code> 코드4<br> xt.shape = <span class="math inline">\((1,H_{in}) \to (H_{in})\)</span><br> ht.shape = <span class="math inline">\((1,H_{out}) \to (H_{out})\)</span><br> 더 간단한 차원을 가진 텐서를 입력으로 해도 무방하다.</p>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1"></a>torch.manual_seed(<span class="dv">43052</span>)</span>
<span id="cb39-2"><a href="#cb39-2"></a>lstmcell <span class="op">=</span> torch.nn.LSTMCell(<span class="dv">7</span>,<span class="dv">4</span>).to(<span class="st">"cuda:0"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1"></a>xt <span class="op">=</span> x[<span class="dv">1</span>]</span>
<span id="cb40-2"><a href="#cb40-2"></a>_h0,_c0 <span class="op">=</span> torch.zeros(<span class="dv">4</span>).to(<span class="st">"cuda"</span>),torch.zeros(<span class="dv">4</span>).to(<span class="st">"cuda"</span>)</span>
<span id="cb40-3"><a href="#cb40-3"></a>xt.shape,_h0.shape,_c0.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>(torch.Size([7]), torch.Size([4]), torch.Size([4]))</code></pre>
</div>
</div>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1"></a>lstmcell(xt,(_h0,_c0))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>(tensor([-0.0290, -0.1758, -0.0537,  0.0598], device='cuda:0',
        grad_fn=&lt;SqueezeBackward1&gt;),
 tensor([-0.0582, -0.4566, -0.1256,  0.1922], device='cuda:0',
        grad_fn=&lt;SqueezeBackward1&gt;))</code></pre>
</div>
</div>
</section>
</section>
<section id="요약" class="level1">
<h1>요약</h1>
<section id="똑같은-코드들-정리" class="level2">
<h2 class="anchored" data-anchor-id="똑같은-코드들-정리">똑같은 코드들 정리</h2>
<p><code>-</code> 1은 단순한 observation의 차원이 아니다. <code>-</code> 네트워크가(1) 단방향 (2)배치가없는(조각이 없는) (3)중첩하지 않은(다계층이 아닌) 순환망에 한해서는 observation 처럼 생각해도 무방하다. –&gt; 엄밀하게는 위험한 생각입니다.</p>
</section>
<section id="실제구현시" class="level2">
<h2 class="anchored" data-anchor-id="실제구현시">실제구현시</h2>
<p><code>-</code> 현실적으로 (1)-(3)이 아닌 조건에서는 Cell 단위로 연산을 이용할 일이 없다. (느립니다.단지 이해용)<br> <code>-</code> torch.nn.RNN or torch.nn.LSTM으로 네트워크를 구성할 시 _h0,_c0의 dim을 명시할 일도 없다.<br> <code>-</code> 입력시계열데이터를 배치로 나누는 경우에 대한 개념만 명확하게 잡으면 된다.배치로 나눌지 말지 나누면 어떻게 되고 안나누면 어떻게 되는지 명확하게 알자.</p>
</section>
</section>
<section id="하나의-긴-시계열데이터를-배치로-나눠서-학습해보기-구현" class="level1">
<h1>하나의 긴 시계열데이터를 배치로 나눠서 학습해보기 구현</h1>
</section>
<section id="data" class="level1">
<h1>data</h1>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1"></a>txt <span class="op">=</span> <span class="bu">list</span>(<span class="st">"hi!"</span>)<span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="bu">list</span>(<span class="st">"hi?"</span>) <span class="op">*</span> <span class="dv">3</span></span>
<span id="cb44-2"><a href="#cb44-2"></a>txt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>['h',
 'i',
 '!',
 'h',
 'i',
 '!',
 'h',
 'i',
 '!',
 'h',
 'i',
 '?',
 'h',
 'i',
 '?',
 'h',
 'i',
 '?']</code></pre>
</div>
</div>
<section id="하나의-긴-시계열데이터를-배치로-나누지-않고-학습" class="level2">
<h2 class="anchored" data-anchor-id="하나의-긴-시계열데이터를-배치로-나누지-않고-학습">하나의 긴 시계열데이터를 배치로 나누지 않고 학습</h2>
<ul>
<li>배치로 나눴을 경우와 비교하기 위해 먼저 나누지 않고 학습진행.</li>
</ul>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1"></a>txt_x <span class="op">=</span> txt[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb46-2"><a href="#cb46-2"></a>txt_y <span class="op">=</span> txt[<span class="dv">1</span>:]</span>
<span id="cb46-3"><a href="#cb46-3"></a>mapping <span class="op">=</span> {<span class="st">"!"</span>: <span class="dv">0</span> ,<span class="st">"?"</span>:<span class="dv">1</span> , <span class="st">"h"</span>:<span class="dv">2</span> ,<span class="st">"i"</span> : <span class="dv">3</span>}</span>
<span id="cb46-4"><a href="#cb46-4"></a>x <span class="op">=</span> torch.nn.functional.one_hot(torch.tensor(f(txt_x,mapping))).<span class="bu">float</span>().to(<span class="st">"cuda"</span>)</span>
<span id="cb46-5"><a href="#cb46-5"></a>y <span class="op">=</span> torch.nn.functional.one_hot(torch.tensor(f(txt_y,mapping))).<span class="bu">float</span>().to(<span class="st">"cuda"</span>)</span>
<span id="cb46-6"><a href="#cb46-6"></a><span class="bu">print</span>(x.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>torch.Size([17, 4])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1"></a>torch.manual_seed(<span class="dv">43052</span>)</span>
<span id="cb48-2"><a href="#cb48-2"></a>lstm <span class="op">=</span> torch.nn.LSTM(<span class="dv">4</span>,<span class="dv">10</span>).to(<span class="st">"cuda"</span>)</span>
<span id="cb48-3"><a href="#cb48-3"></a>linr <span class="op">=</span> torch.nn.Linear(<span class="dv">10</span>,<span class="dv">4</span>).to(<span class="st">"cuda"</span>)</span>
<span id="cb48-4"><a href="#cb48-4"></a>loss_fn <span class="op">=</span> torch.nn.CrossEntropyLoss()</span>
<span id="cb48-5"><a href="#cb48-5"></a>optimizer <span class="op">=</span> torch.optim.Adam(<span class="bu">list</span>(lstm.parameters()) <span class="op">+</span> <span class="bu">list</span>(linr.parameters()))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1"></a><span class="cf">for</span> epoch <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1000</span>):</span>
<span id="cb49-2"><a href="#cb49-2"></a>    <span class="co">## 1</span></span>
<span id="cb49-3"><a href="#cb49-3"></a>    hidden,(h_T,c_T) <span class="op">=</span> lstm(x)</span>
<span id="cb49-4"><a href="#cb49-4"></a>    <span class="co">#hidden은 가장 깊이 있는 은닉계층의 모든 시점에서 output이므로 hidden.shape = (17,10)</span></span>
<span id="cb49-5"><a href="#cb49-5"></a>    <span class="co">#h_T,c_T는 모든 은닉계층에서 마지막 시점에서 output이므로 h_T(c_T).shape = c_T.shape = (1,10)</span></span>
<span id="cb49-6"><a href="#cb49-6"></a>    <span class="bu">print</span>(hidden.shape,h_T.shape,c_T.shape)</span>
<span id="cb49-7"><a href="#cb49-7"></a>    output <span class="op">=</span> linr(hidden)</span>
<span id="cb49-8"><a href="#cb49-8"></a>    <span class="co">## 2</span></span>
<span id="cb49-9"><a href="#cb49-9"></a>    loss <span class="op">=</span> loss_fn(output,y)</span>
<span id="cb49-10"><a href="#cb49-10"></a>    <span class="co">## 3</span></span>
<span id="cb49-11"><a href="#cb49-11"></a>    loss.backward()</span>
<span id="cb49-12"><a href="#cb49-12"></a>    <span class="co">## 4</span></span>
<span id="cb49-13"><a href="#cb49-13"></a>    optimizer.step()</span>
<span id="cb49-14"><a href="#cb49-14"></a>    optimizer.zero_grad()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])
torch.Size([17, 10]) torch.Size([1, 10]) torch.Size([1, 10])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb51-2"><a href="#cb51-2"></a>soft <span class="op">=</span> torch.nn.Softmax(dim<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb51-3"><a href="#cb51-3"></a>plt.matshow(soft(output).to(<span class="st">"cpu"</span>).data,cmap<span class="op">=</span><span class="st">'bwr'</span>,vmin<span class="op">=-</span><span class="dv">1</span>,vmax<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>&lt;matplotlib.image.AxesImage at 0x165602a6d30&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="DL 12-01_files/figure-html/cell-33-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="하나의-긴-시계열-데이터를-배치로-나눠서-학습" class="level2">
<h2 class="anchored" data-anchor-id="하나의-긴-시계열-데이터를-배치로-나눠서-학습">하나의 긴 시계열 데이터를 배치로 나눠서 학습</h2>
<p>시계열 데이터셋이 배치로 나뉘어져 있을 경우,파이토치에서는 <span class="math inline">\((L,N,H_{in})\)</span>의 shape을 요구한다. 다음의 과정은 shape을 맞추기 위해 진행하는 과정이다.</p>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1"></a>txt1 <span class="op">=</span> txt[:<span class="dv">9</span>]</span>
<span id="cb53-2"><a href="#cb53-2"></a>txt2 <span class="op">=</span> txt[<span class="dv">9</span>:]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1"></a>txt1_x <span class="op">=</span> txt1[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb54-2"><a href="#cb54-2"></a>txt1_y <span class="op">=</span> txt1[<span class="dv">1</span>:]</span>
<span id="cb54-3"><a href="#cb54-3"></a>txt2_x <span class="op">=</span> txt2[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb54-4"><a href="#cb54-4"></a>txt2_y <span class="op">=</span> txt2[<span class="dv">1</span>:]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1"></a>mapping <span class="op">=</span> {<span class="st">"!"</span>:<span class="dv">0</span>,<span class="st">"?"</span>:<span class="dv">1</span>,<span class="st">"h"</span>:<span class="dv">2</span>,<span class="st">"i"</span>:<span class="dv">3</span>}</span>
<span id="cb55-2"><a href="#cb55-2"></a>x1 <span class="op">=</span> torch.nn.functional.one_hot(torch.tensor(f(txt1_x,mapping))).<span class="bu">float</span>().to(<span class="st">"cuda"</span>)</span>
<span id="cb55-3"><a href="#cb55-3"></a>y1 <span class="op">=</span> torch.nn.functional.one_hot(torch.tensor(f(txt1_y,mapping))).<span class="bu">float</span>().to(<span class="st">"cuda"</span>)</span>
<span id="cb55-4"><a href="#cb55-4"></a>x2 <span class="op">=</span> torch.nn.functional.one_hot(torch.tensor(f(txt2_x,mapping))).<span class="bu">float</span>().to(<span class="st">"cuda"</span>)</span>
<span id="cb55-5"><a href="#cb55-5"></a>y2 <span class="op">=</span> torch.nn.functional.one_hot(torch.tensor(f(txt2_y,mapping))).<span class="bu">float</span>().to(<span class="st">"cuda"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1"></a>x1.shape,y1.shape,x2.shape,y2.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>(torch.Size([8, 4]),
 torch.Size([8, 4]),
 torch.Size([8, 4]),
 torch.Size([8, 4]))</code></pre>
</div>
</div>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1"></a>xx <span class="op">=</span> torch.stack([x1,x2],axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb58-2"><a href="#cb58-2"></a>yy <span class="op">=</span> torch.stack([y1,y2],axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb58-3"><a href="#cb58-3"></a>xx.shape,yy.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code>(torch.Size([8, 2, 4]), torch.Size([8, 2, 4]))</code></pre>
</div>
</div>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1"></a>xx,yy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>(tensor([[[0., 0., 1., 0.],
          [0., 0., 1., 0.]],
 
         [[0., 0., 0., 1.],
          [0., 0., 0., 1.]],
 
         [[1., 0., 0., 0.],
          [0., 1., 0., 0.]],
 
         [[0., 0., 1., 0.],
          [0., 0., 1., 0.]],
 
         [[0., 0., 0., 1.],
          [0., 0., 0., 1.]],
 
         [[1., 0., 0., 0.],
          [0., 1., 0., 0.]],
 
         [[0., 0., 1., 0.],
          [0., 0., 1., 0.]],
 
         [[0., 0., 0., 1.],
          [0., 0., 0., 1.]]], device='cuda:0'),
 tensor([[[0., 0., 0., 1.],
          [0., 0., 0., 1.]],
 
         [[1., 0., 0., 0.],
          [0., 1., 0., 0.]],
 
         [[0., 0., 1., 0.],
          [0., 0., 1., 0.]],
 
         [[0., 0., 0., 1.],
          [0., 0., 0., 1.]],
 
         [[1., 0., 0., 0.],
          [0., 1., 0., 0.]],
 
         [[0., 0., 1., 0.],
          [0., 0., 1., 0.]],
 
         [[0., 0., 0., 1.],
          [0., 0., 0., 1.]],
 
         [[1., 0., 0., 0.],
          [0., 1., 0., 0.]]], device='cuda:0'))</code></pre>
</div>
</div>
<p>torch.stack에서 axis의 인자로 1을 넣어 <span class="math inline">\(batch size = 2\)</span>인 <span class="math inline">\((8,2,4)\)</span>의 shape을 가지는 텐서를 만듦</p>
<p>준비단계</p>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1"></a>torch.manual_seed(<span class="dv">43052</span>)</span>
<span id="cb62-2"><a href="#cb62-2"></a>lstm <span class="op">=</span> torch.nn.LSTM(<span class="dv">4</span>,<span class="dv">10</span>).to(<span class="st">"cuda"</span>)</span>
<span id="cb62-3"><a href="#cb62-3"></a>linr <span class="op">=</span> torch.nn.Linear(<span class="dv">10</span>,<span class="dv">4</span>).to(<span class="st">"cuda"</span>)</span>
<span id="cb62-4"><a href="#cb62-4"></a>loss_fn <span class="op">=</span> torch.nn.CrossEntropyLoss()</span>
<span id="cb62-5"><a href="#cb62-5"></a>optimizer <span class="op">=</span> torch.optim.Adam(<span class="bu">list</span>(lstm.parameters())<span class="op">+</span><span class="bu">list</span>(linr.parameters()),lr <span class="op">=</span> <span class="fl">0.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>학습단계 - 먼저 관찰하기위해서 ’hi!’가 3번반복되는 배치와 hi?가 3번반복되는 배치를 따로 분리하고 네트워크에 입력하여 학습.</p>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1"></a><span class="cf">for</span> epoch <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">100</span>):</span>
<span id="cb63-2"><a href="#cb63-2"></a>    <span class="co">## 1</span></span>
<span id="cb63-3"><a href="#cb63-3"></a>    hidden,(h_T,c_T) <span class="op">=</span> lstm(xx)</span>
<span id="cb63-4"><a href="#cb63-4"></a>    <span class="co">#hidden은 가장 깊이 있는 은닉계층의 모든 시점에서 output이므로 hidden.shape = (17,10)</span></span>
<span id="cb63-5"><a href="#cb63-5"></a>    <span class="co">#h_T,c_T는 모든 은닉계층에서 마지막 시점에서 output이므로 h_T(c_T).shape = c_T.shape = (1,10)</span></span>
<span id="cb63-6"><a href="#cb63-6"></a>    <span class="co">#print(hidden.shape,h_T.shape,c_T.shape)</span></span>
<span id="cb63-7"><a href="#cb63-7"></a>    output <span class="op">=</span> linr(hidden)</span>
<span id="cb63-8"><a href="#cb63-8"></a>    <span class="co">## 2</span></span>
<span id="cb63-9"><a href="#cb63-9"></a>    loss <span class="op">=</span> loss_fn(output[:,<span class="dv">0</span>,:],yy[:,<span class="dv">0</span>,:]) <span class="op">+</span> loss_fn(output[:,<span class="dv">1</span>,:],yy[:,<span class="dv">1</span>,:])</span>
<span id="cb63-10"><a href="#cb63-10"></a>    <span class="cf">if</span> epoch <span class="op">%</span> <span class="dv">20</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb63-11"><a href="#cb63-11"></a>        <span class="bu">print</span>(epoch,loss)</span>
<span id="cb63-12"><a href="#cb63-12"></a>    <span class="co">## 3</span></span>
<span id="cb63-13"><a href="#cb63-13"></a>    loss.backward()</span>
<span id="cb63-14"><a href="#cb63-14"></a>    <span class="co">## 4</span></span>
<span id="cb63-15"><a href="#cb63-15"></a>    optimizer.step()</span>
<span id="cb63-16"><a href="#cb63-16"></a>    optimizer.zero_grad()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0 tensor(2.7541, device='cuda:0', grad_fn=&lt;AddBackward0&gt;)
20 tensor(0.1803, device='cuda:0', grad_fn=&lt;AddBackward0&gt;)
40 tensor(0.1739, device='cuda:0', grad_fn=&lt;AddBackward0&gt;)
60 tensor(0.1735, device='cuda:0', grad_fn=&lt;AddBackward0&gt;)
80 tensor(0.1735, device='cuda:0', grad_fn=&lt;AddBackward0&gt;)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1"></a>fig,ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb65-2"><a href="#cb65-2"></a>ax[<span class="dv">0</span>].matshow(soft(output[:,<span class="dv">0</span>,:]).to(<span class="st">"cpu"</span>).data,cmap<span class="op">=</span><span class="st">"bwr"</span>,vmin<span class="op">=-</span><span class="dv">1</span>,vmax<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb65-3"><a href="#cb65-3"></a>ax[<span class="dv">1</span>].matshow(soft(output[:,<span class="dv">1</span>,:]).to(<span class="st">"cpu"</span>).data,cmap<span class="op">=</span><span class="st">"bwr"</span>,vmin<span class="op">=-</span><span class="dv">1</span>,vmax<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<pre><code>&lt;matplotlib.image.AxesImage at 0x16563cda370&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="DL 12-01_files/figure-html/cell-42-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1"></a>hidden,_ <span class="op">=</span> lstm(x)</span>
<span id="cb67-2"><a href="#cb67-2"></a>plt.matshow(soft(linr(hidden)).to(<span class="st">"cpu"</span>).data,cmap<span class="op">=</span><span class="st">"bwr"</span>,vmin<span class="op">=-</span><span class="dv">1</span>,vmax<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>&lt;matplotlib.image.AxesImage at 0x165645e1df0&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="DL 12-01_files/figure-html/cell-43-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>hi?와 hi!인 경우를 분리하여 각각 네트워크를 학습시킬 경우, 분리된 데이터에 대해 잘 예측함<br></p>
<p>그런데 hi!와 hi?가 분리되어 있지 않은 전체데이터를 입력으로 줬을때는 전혀 예측을 하지 못하는 모습… 이는 hi!와 hi?를 따로따로 분리하여 학습해서 !가 나오면 hi!만 반복되고 ?가 나오면 hi?만 반복되는 것으로 학습했기 때문이다. 이렇게 학습을 시키면 hi!가 3번나온 뒤 hi?가 3번나오는 데이터를 모델링하지 못한다.연결,흐름,경향은 학습하지 못했기 때문이다.</p>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1"></a>yy.shape,y.shape,xx.shape,x.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>(torch.Size([8, 2, 4]),
 torch.Size([17, 4]),
 torch.Size([8, 2, 4]),
 torch.Size([17, 4]))</code></pre>
</div>
</div>
</section>
<section id="재미있는-실험" class="level2">
<h2 class="anchored" data-anchor-id="재미있는-실험">재미있는 실험</h2>
<p><code>-</code> x1만 배운네트워크에 x2를 넣는다면?<br> <code>-</code> 즉, hi!만 배운 네트워크에 hi?데이터에 대해서 예측하라 하면?</p>
<p>준비단계</p>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1"></a>torch.manual_seed(<span class="dv">43052</span>)</span>
<span id="cb71-2"><a href="#cb71-2"></a>lstm <span class="op">=</span> torch.nn.LSTM(<span class="dv">4</span>,<span class="dv">10</span>).to(<span class="st">"cuda"</span>)</span>
<span id="cb71-3"><a href="#cb71-3"></a>linr <span class="op">=</span> torch.nn.Linear(<span class="dv">10</span>,<span class="dv">4</span>).to(<span class="st">"cuda"</span>)</span>
<span id="cb71-4"><a href="#cb71-4"></a></span>
<span id="cb71-5"><a href="#cb71-5"></a>loss_fn <span class="op">=</span> torch.nn.CrossEntropyLoss()</span>
<span id="cb71-6"><a href="#cb71-6"></a>optimizer<span class="op">=</span> torch.optim.Adam(<span class="bu">list</span>(lstm.parameters())<span class="op">+</span><span class="bu">list</span>(linr.parameters()),lr<span class="op">=</span><span class="fl">0.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1"></a><span class="cf">for</span> epoch <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">100</span>):</span>
<span id="cb72-2"><a href="#cb72-2"></a>    <span class="co">##1 output</span></span>
<span id="cb72-3"><a href="#cb72-3"></a>    hidden,(h_T,c_T) <span class="op">=</span> lstm(x1)</span>
<span id="cb72-4"><a href="#cb72-4"></a>    output <span class="op">=</span> linr(hidden)</span>
<span id="cb72-5"><a href="#cb72-5"></a>    <span class="co">##2 loss</span></span>
<span id="cb72-6"><a href="#cb72-6"></a>    loss <span class="op">=</span> loss_fn(output,y1)</span>
<span id="cb72-7"><a href="#cb72-7"></a>    <span class="co">##3 derivative</span></span>
<span id="cb72-8"><a href="#cb72-8"></a>    loss.backward()</span>
<span id="cb72-9"><a href="#cb72-9"></a>    <span class="co">##4 update &amp; clean</span></span>
<span id="cb72-10"><a href="#cb72-10"></a>    optimizer.step()</span>
<span id="cb72-11"><a href="#cb72-11"></a>    optimizer.zero_grad()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1"></a>hidden,(h_T,c_T) <span class="op">=</span> lstm(x2)</span>
<span id="cb73-2"><a href="#cb73-2"></a>plt.matshow(soft(linr(hidden)).data.to(<span class="st">"cpu"</span>),cmap<span class="op">=</span><span class="st">"bwr"</span>,vmin<span class="op">=-</span><span class="dv">1</span>,vmax<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<pre><code>&lt;matplotlib.image.AxesImage at 0x16566df0760&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="DL 12-01_files/figure-html/cell-47-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>hi?를 넣어도 hi!로 예측함!<br> 만약 x2만 넣은 경우도 마찬가지 결과가 나온다(생략)</p>
<p>정리 : 하나의 긴 시계열 데이터를 n개의 배치들로 나누어서 학습할 수 있다. 다만 이러한 경우에 전체시계열데이터의를 네트워크에 학습시키는 것이 아니기 때문에 전체적인 패턴,흐름,연결은 학습하지 못한다.</p>
</section>
<section id="왜-배치로-나눠서-시계열-데이터를-학습해야-하는가" class="level2">
<h2 class="anchored" data-anchor-id="왜-배치로-나눠서-시계열-데이터를-학습해야-하는가">왜 배치로 나눠서 시계열 데이터를 학습해야 하는가?</h2>
<ol type="1">
<li>속도가 빠르다.</li>
<li>연결,흐름을 파악하지 않아도 되는 독립적인 시계열 데이터셋이 있는 경우도 있다.(예를들어,독립적인 여러개의 댓글이 있는 시계열 데이터셋의 경우)</li>
<li>이해하지 못했다 … ㅜㅜ</li>
</ol>
<p>참고<br> 배치사이즈는 배치가 몇개인가? or 배치안에 있는 원소가 몇개인가? 두가지 서로다른 의미가 있다. document별로 알아서 해석해야 한다.</p>
</section>
<section id="똑같은-코드들-fastaipytorch" class="level2">
<h2 class="anchored" data-anchor-id="똑같은-코드들-fastaipytorch">똑같은 코드들 fastai,pytorch</h2>
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1"></a>txt <span class="op">=</span> ([<span class="st">'one'</span>,<span class="st">','</span>,<span class="st">'two'</span>,<span class="st">','</span>,<span class="st">'three'</span>,<span class="st">','</span>,<span class="st">'four'</span>,<span class="st">','</span>,<span class="st">'five'</span>,<span class="st">','</span>]<span class="op">*</span><span class="dv">100</span>)[:<span class="op">-</span><span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1"></a>mapping <span class="op">=</span> {<span class="st">','</span>:<span class="dv">0</span>, <span class="st">'one'</span>:<span class="dv">1</span>, <span class="st">'two'</span>:<span class="dv">2</span>, <span class="st">'three'</span>:<span class="dv">3</span>, <span class="st">'four'</span>:<span class="dv">4</span>, <span class="st">'five'</span>:<span class="dv">5</span>} </span>
<span id="cb76-2"><a href="#cb76-2"></a>mapping</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<pre><code>{',': 0, 'one': 1, 'two': 2, 'three': 3, 'four': 4, 'five': 5}</code></pre>
</div>
</div>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1"></a>txt_x <span class="op">=</span> txt[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb78-2"><a href="#cb78-2"></a>txt_y <span class="op">=</span> txt[<span class="dv">1</span>:]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1"></a>txt_x[<span class="dv">0</span>:<span class="dv">5</span>], txt_y[<span class="dv">0</span>:<span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<pre><code>(['one', ',', 'two', ',', 'three'], [',', 'two', ',', 'three', ','])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1"></a>x <span class="op">=</span> torch.nn.functional.one_hot(torch.tensor(f(txt_x,mapping))).<span class="bu">float</span>().to(<span class="st">"cuda"</span>)</span>
<span id="cb81-2"><a href="#cb81-2"></a>y <span class="op">=</span> torch.nn.functional.one_hot(torch.tensor(f(txt_y,mapping))).<span class="bu">float</span>().to(<span class="st">"cuda"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="fastai-사용" class="level2">
<h2 class="anchored" data-anchor-id="fastai-사용">fastai 사용</h2>
<div class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1"></a><span class="im">from</span> fastai.text.<span class="bu">all</span> <span class="im">import</span> <span class="op">*</span></span>
<span id="cb82-2"><a href="#cb82-2"></a><span class="co">#import pytorch_lightning as pl </span></span>
<span id="cb82-3"><a href="#cb82-3"></a>tr_ds <span class="op">=</span> torch.utils.data.TensorDataset(x,y) </span>
<span id="cb82-4"><a href="#cb82-4"></a>val_ds <span class="op">=</span> torch.utils.data.TensorDataset(x,y) <span class="co">#dummy,validation이 있다고 가정</span></span>
<span id="cb82-5"><a href="#cb82-5"></a>tr_ldr <span class="op">=</span> torch.utils.data.DataLoader(tr_ds,batch_size<span class="op">=</span><span class="dv">998</span>) <span class="co">#한개의 배치안에 998개의 원소가 있도록</span></span>
<span id="cb82-6"><a href="#cb82-6"></a>val_ldr <span class="op">=</span> torch.utils.data.DataLoader(val_ds,batch_size<span class="op">=</span><span class="dv">998</span>)</span>
<span id="cb82-7"><a href="#cb82-7"></a>dls <span class="op">=</span> DataLoaders(tr_ldr,val_ldr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1"></a><span class="kw">class</span> MyLSTM(torch.nn.Module):</span>
<span id="cb83-2"><a href="#cb83-2"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb83-3"><a href="#cb83-3"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>()</span>
<span id="cb83-4"><a href="#cb83-4"></a>        torch.manual_seed(<span class="dv">43052</span>)</span>
<span id="cb83-5"><a href="#cb83-5"></a>        <span class="va">self</span>.lstm <span class="op">=</span> torch.nn.LSTM(<span class="dv">6</span>,<span class="dv">20</span>)</span>
<span id="cb83-6"><a href="#cb83-6"></a>        <span class="va">self</span>.linr <span class="op">=</span> torch.nn.Linear(<span class="dv">20</span>,<span class="dv">6</span>) </span>
<span id="cb83-7"><a href="#cb83-7"></a>    <span class="kw">def</span> forward(<span class="va">self</span>,x):</span>
<span id="cb83-8"><a href="#cb83-8"></a>        _water <span class="op">=</span> torch.zeros(<span class="dv">1</span>,<span class="dv">20</span>).to(<span class="st">"cuda:0"</span>)</span>
<span id="cb83-9"><a href="#cb83-9"></a>        hidden, (hT,cT) <span class="op">=</span><span class="va">self</span>.lstm(x,(_water,_water))</span>
<span id="cb83-10"><a href="#cb83-10"></a>        output <span class="op">=</span> <span class="va">self</span>.linr(hidden)</span>
<span id="cb83-11"><a href="#cb83-11"></a>        <span class="cf">return</span> output         </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1"></a>net <span class="op">=</span> MyLSTM().to(<span class="st">"cuda"</span>)</span>
<span id="cb84-2"><a href="#cb84-2"></a>loss_fn <span class="op">=</span> torch.nn.CrossEntropyLoss()</span>
<span id="cb84-3"><a href="#cb84-3"></a><span class="co">#optimizer 생략(fastai 구현시)</span></span>
<span id="cb84-4"><a href="#cb84-4"></a>lrnr <span class="op">=</span> Learner(dls,net,loss_fn,lr <span class="op">=</span> <span class="fl">0.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1"></a>lrnr.fit(<span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1.762846</td>
      <td>1.502211</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1.631212</td>
      <td>1.620583</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1.627597</td>
      <td>1.443686</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>3</td>
      <td>1.580216</td>
      <td>1.368762</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>4</td>
      <td>1.536200</td>
      <td>1.307310</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>5</td>
      <td>1.496099</td>
      <td>1.216339</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>6</td>
      <td>1.453670</td>
      <td>1.113821</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>7</td>
      <td>1.408125</td>
      <td>1.019931</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>8</td>
      <td>1.361426</td>
      <td>0.941434</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>9</td>
      <td>1.315507</td>
      <td>0.884033</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>10</td>
      <td>1.272201</td>
      <td>0.848489</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>11</td>
      <td>1.232838</td>
      <td>0.826641</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>12</td>
      <td>1.197666</td>
      <td>0.814630</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>13</td>
      <td>1.166570</td>
      <td>0.809186</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>14</td>
      <td>1.139229</td>
      <td>0.805969</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>15</td>
      <td>1.115098</td>
      <td>0.798611</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>16</td>
      <td>1.093322</td>
      <td>0.779956</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>17</td>
      <td>1.072764</td>
      <td>0.746476</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>18</td>
      <td>1.052292</td>
      <td>0.703937</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>19</td>
      <td>1.031332</td>
      <td>0.643301</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>20</td>
      <td>1.008886</td>
      <td>0.574666</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>21</td>
      <td>0.984684</td>
      <td>0.496858</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>22</td>
      <td>0.958432</td>
      <td>0.423367</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>23</td>
      <td>0.930580</td>
      <td>0.360229</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>24</td>
      <td>0.901813</td>
      <td>0.301070</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>25</td>
      <td>0.872408</td>
      <td>0.251317</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>26</td>
      <td>0.842863</td>
      <td>0.199397</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>27</td>
      <td>0.813075</td>
      <td>0.151757</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>28</td>
      <td>0.783244</td>
      <td>0.109921</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>29</td>
      <td>0.753616</td>
      <td>0.079872</td>
      <td>00:00</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<div class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1"></a>soft(lrnr.model(x)).data.to(<span class="st">"cpu"</span>).numpy().<span class="bu">round</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="56">
<pre><code>array([[0.998, 0.   , 0.002, 0.   , 0.   , 0.   ],
       [0.   , 0.018, 0.514, 0.097, 0.096, 0.275],
       [1.   , 0.   , 0.   , 0.   , 0.   , 0.   ],
       ...,
       [0.001, 0.002, 0.025, 0.001, 0.938, 0.033],
       [1.   , 0.   , 0.   , 0.   , 0.   , 0.   ],
       [0.   , 0.066, 0.049, 0.005, 0.079, 0.8  ]], dtype=float32)</code></pre>
</div>
</div>
</section>
<section id="torch사용" class="level2">
<h2 class="anchored" data-anchor-id="torch사용">torch사용</h2>
<div class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1"></a>torch.manual_seed(<span class="dv">43052</span>) </span>
<span id="cb88-2"><a href="#cb88-2"></a>lstm <span class="op">=</span> torch.nn.LSTM(<span class="dv">6</span>,<span class="dv">20</span>).to(<span class="st">"cuda:0"</span>) </span>
<span id="cb88-3"><a href="#cb88-3"></a>linr <span class="op">=</span> torch.nn.Linear(<span class="dv">20</span>,<span class="dv">6</span>).to(<span class="st">"cuda:0"</span>) </span>
<span id="cb88-4"><a href="#cb88-4"></a>loss_fn <span class="op">=</span> torch.nn.CrossEntropyLoss()</span>
<span id="cb88-5"><a href="#cb88-5"></a>optimizr <span class="op">=</span> Adam(<span class="bu">list</span>(lstm.parameters())<span class="op">+</span><span class="bu">list</span>(linr.parameters()),lr<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb88-6"><a href="#cb88-6"></a><span class="co">#동일함을 보이기 위해 fastai의 Adam사용</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1"></a><span class="cf">for</span> epoc <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>):</span>
<span id="cb89-2"><a href="#cb89-2"></a>    <span class="co">## 1 </span></span>
<span id="cb89-3"><a href="#cb89-3"></a>    hidden, _ <span class="op">=</span> lstm(x)</span>
<span id="cb89-4"><a href="#cb89-4"></a>    output <span class="op">=</span> linr(hidden) </span>
<span id="cb89-5"><a href="#cb89-5"></a>    <span class="co">## 2 </span></span>
<span id="cb89-6"><a href="#cb89-6"></a>    loss <span class="op">=</span> loss_fn(output,y) </span>
<span id="cb89-7"><a href="#cb89-7"></a>    <span class="co">## 3 </span></span>
<span id="cb89-8"><a href="#cb89-8"></a>    loss.backward()</span>
<span id="cb89-9"><a href="#cb89-9"></a>    <span class="co">## 4 </span></span>
<span id="cb89-10"><a href="#cb89-10"></a>    optimizr.step()</span>
<span id="cb89-11"><a href="#cb89-11"></a>    optimizr.zero_grad()     </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1"></a>hidden, _ <span class="op">=</span> lstm(x)</span>
<span id="cb90-2"><a href="#cb90-2"></a>output <span class="op">=</span> linr(hidden) </span>
<span id="cb90-3"><a href="#cb90-3"></a>soft(output).data.to(<span class="st">"cpu"</span>).numpy().<span class="bu">round</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="60">
<pre><code>array([[0.935, 0.009, 0.015, 0.011, 0.016, 0.014],
       [0.133, 0.164, 0.242, 0.172, 0.141, 0.147],
       [0.982, 0.003, 0.004, 0.003, 0.004, 0.003],
       ...,
       [0.122, 0.171, 0.242, 0.174, 0.146, 0.144],
       [0.984, 0.003, 0.004, 0.002, 0.004, 0.003],
       [0.119, 0.172, 0.244, 0.175, 0.145, 0.145]], dtype=float32)</code></pre>
</div>
</div>
</section>
<section id="human-numbers-100" class="level2">
<h2 class="anchored" data-anchor-id="human-numbers-100">human numbers 100</h2>
<div class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'https://raw.githubusercontent.com/guebin/DL2022/main/posts/IV.%20RNN/2022-11-25-human_numbers_100.csv'</span>)</span>
<span id="cb92-2"><a href="#cb92-2"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="61">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>text</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>one, two, three, four, five, six, seven, eight, nine, ten, eleven, twelve, thirteen, fourteen, fifteen, sixteen, seventeen, eighteen, nineteen, twenty, twenty one, twenty two, twenty three, twenty four, twenty five, twenty six, twenty seven, twenty eight, twenty nine, thirty, thirty one, thirty two, thirty three, thirty four, thirty five, thirty six, thirty seven, thirty eight, thirty nine, forty, forty one, forty two, forty three, forty four, forty five, forty six, forty seven, forty eight, forty nine, fifty, fifty one, fifty two, fifty three, fifty four, fifty five, fifty six, fifty seve...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>one, two, three, four, five, six, seven, eight, nine, ten, eleven, twelve, thirteen, fourteen, fifteen, sixteen, seventeen, eighteen, nineteen, twenty, twenty one, twenty two, twenty three, twenty four, twenty five, twenty six, twenty seven, twenty eight, twenty nine, thirty, thirty one, thirty two, thirty three, thirty four, thirty five, thirty six, thirty seven, thirty eight, thirty nine, forty, forty one, forty two, forty three, forty four, forty five, forty six, forty seven, forty eight, forty nine, fifty, fifty one, fifty two, fifty three, fifty four, fifty five, fifty six, fifty seve...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>one, two, three, four, five, six, seven, eight, nine, ten, eleven, twelve, thirteen, fourteen, fifteen, sixteen, seventeen, eighteen, nineteen, twenty, twenty one, twenty two, twenty three, twenty four, twenty five, twenty six, twenty seven, twenty eight, twenty nine, thirty, thirty one, thirty two, thirty three, thirty four, thirty five, thirty six, thirty seven, thirty eight, thirty nine, forty, forty one, forty two, forty three, forty four, forty five, forty six, forty seven, forty eight, forty nine, fifty, fifty one, fifty two, fifty three, fifty four, fifty five, fifty six, fifty seve...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>one, two, three, four, five, six, seven, eight, nine, ten, eleven, twelve, thirteen, fourteen, fifteen, sixteen, seventeen, eighteen, nineteen, twenty, twenty one, twenty two, twenty three, twenty four, twenty five, twenty six, twenty seven, twenty eight, twenty nine, thirty, thirty one, thirty two, thirty three, thirty four, thirty five, thirty six, thirty seven, thirty eight, thirty nine, forty, forty one, forty two, forty three, forty four, forty five, forty six, forty seven, forty eight, forty nine, fifty, fifty one, fifty two, fifty three, fifty four, fifty five, fifty six, fifty seve...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>one, two, three, four, five, six, seven, eight, nine, ten, eleven, twelve, thirteen, fourteen, fifteen, sixteen, seventeen, eighteen, nineteen, twenty, twenty one, twenty two, twenty three, twenty four, twenty five, twenty six, twenty seven, twenty eight, twenty nine, thirty, thirty one, thirty two, thirty three, thirty four, thirty five, thirty six, thirty seven, thirty eight, thirty nine, forty, forty one, forty two, forty three, forty four, forty five, forty six, forty seven, forty eight, forty nine, fifty, fifty one, fifty two, fifty three, fifty four, fifty five, fifty six, fifty seve...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>1995</th>
      <td>one, two, three, four, five, six, seven, eight, nine, ten, eleven, twelve, thirteen, fourteen, fifteen, sixteen, seventeen, eighteen, nineteen, twenty, twenty one, twenty two, twenty three, twenty four, twenty five, twenty six, twenty seven, twenty eight, twenty nine, thirty, thirty one, thirty two, thirty three, thirty four, thirty five, thirty six, thirty seven, thirty eight, thirty nine, forty, forty one, forty two, forty three, forty four, forty five, forty six, forty seven, forty eight, forty nine, fifty, fifty one, fifty two, fifty three, fifty four, fifty five, fifty six, fifty seve...</td>
    </tr>
    <tr>
      <th>1996</th>
      <td>one, two, three, four, five, six, seven, eight, nine, ten, eleven, twelve, thirteen, fourteen, fifteen, sixteen, seventeen, eighteen, nineteen, twenty, twenty one, twenty two, twenty three, twenty four, twenty five, twenty six, twenty seven, twenty eight, twenty nine, thirty, thirty one, thirty two, thirty three, thirty four, thirty five, thirty six, thirty seven, thirty eight, thirty nine, forty, forty one, forty two, forty three, forty four, forty five, forty six, forty seven, forty eight, forty nine, fifty, fifty one, fifty two, fifty three, fifty four, fifty five, fifty six, fifty seve...</td>
    </tr>
    <tr>
      <th>1997</th>
      <td>one, two, three, four, five, six, seven, eight, nine, ten, eleven, twelve, thirteen, fourteen, fifteen, sixteen, seventeen, eighteen, nineteen, twenty, twenty one, twenty two, twenty three, twenty four, twenty five, twenty six, twenty seven, twenty eight, twenty nine, thirty, thirty one, thirty two, thirty three, thirty four, thirty five, thirty six, thirty seven, thirty eight, thirty nine, forty, forty one, forty two, forty three, forty four, forty five, forty six, forty seven, forty eight, forty nine, fifty, fifty one, fifty two, fifty three, fifty four, fifty five, fifty six, fifty seve...</td>
    </tr>
    <tr>
      <th>1998</th>
      <td>one, two, three, four, five, six, seven, eight, nine, ten, eleven, twelve, thirteen, fourteen, fifteen, sixteen, seventeen, eighteen, nineteen, twenty, twenty one, twenty two, twenty three, twenty four, twenty five, twenty six, twenty seven, twenty eight, twenty nine, thirty, thirty one, thirty two, thirty three, thirty four, thirty five, thirty six, thirty seven, thirty eight, thirty nine, forty, forty one, forty two, forty three, forty four, forty five, forty six, forty seven, forty eight, forty nine, fifty, fifty one, fifty two, fifty three, fifty four, fifty five, fifty six, fifty seve...</td>
    </tr>
    <tr>
      <th>1999</th>
      <td>one, two, three, four, five, six, seven, eight, nine, ten, eleven, twelve, thirteen, fourteen, fifteen, sixteen, seventeen, eighteen, nineteen, twenty, twenty one, twenty two, twenty three, twenty four, twenty five, twenty six, twenty seven, twenty eight, twenty nine, thirty, thirty one, thirty two, thirty three, thirty four, thirty five, thirty six, thirty seven, thirty eight, thirty nine, forty, forty one, forty two, forty three, forty four, forty five, forty six, forty seven, forty eight, forty nine, fifty, fifty one, fifty two, fifty three, fifty four, fifty five, fifty six, fifty seve...</td>
    </tr>
  </tbody>
</table>
<p>2000 rows × 1 columns</p>
</div>
</div>
</div>
<section id="생략-..-귀찮음" class="level3">
<h3 class="anchored" data-anchor-id="생략-..-귀찮음">생략 .. 귀찮음</h3>
<div class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1"></a>dls <span class="op">=</span> TextDataLoaders.from_df(df,is_lm<span class="op">=</span><span class="va">True</span>,seq_len<span class="op">=</span><span class="dv">5</span>,text_col<span class="op">=</span><span class="st">'text'</span>)</span>
<span id="cb93-2"><a href="#cb93-2"></a>dls.show_batch()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Due to IPython and Windows limitation, python multiprocessing isn't available now.
So `n_workers` has to be changed to 0 to avoid getting stuck</code></pre>
</div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>text</th>
      <th>text_</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>xxbos one , two ,</td>
      <td>one , two , three</td>
    </tr>
    <tr>
      <th>1</th>
      <td>hundred xxbos one , two</td>
      <td>xxbos one , two ,</td>
    </tr>
    <tr>
      <th>2</th>
      <td>one hundred xxbos one ,</td>
      <td>hundred xxbos one , two</td>
    </tr>
    <tr>
      <th>3</th>
      <td>, one hundred xxbos one</td>
      <td>one hundred xxbos one ,</td>
    </tr>
    <tr>
      <th>4</th>
      <td>nine , one hundred xxbos</td>
      <td>, one hundred xxbos one</td>
    </tr>
    <tr>
      <th>5</th>
      <td>ninety nine , one hundred</td>
      <td>nine , one hundred xxbos</td>
    </tr>
    <tr>
      <th>6</th>
      <td>, ninety nine , one</td>
      <td>ninety nine , one hundred</td>
    </tr>
    <tr>
      <th>7</th>
      <td>eight , ninety nine ,</td>
      <td>, ninety nine , one</td>
    </tr>
    <tr>
      <th>8</th>
      <td>ninety eight , ninety nine</td>
      <td>eight , ninety nine ,</td>
    </tr>
  </tbody>
</table>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>