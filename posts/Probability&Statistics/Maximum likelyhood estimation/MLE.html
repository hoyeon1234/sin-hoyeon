<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="신호연">
<meta name="dcterms.date" content="2022-12-29">

<title>HIHO - Maximum likelyhood estimation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-JE4129QJZV"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-JE4129QJZV', { 'anonymize_ip': true});
</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">HIHO</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html">
 <span class="menu-text">About me</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/hoyeon1234/sin-hoyeon/tree/main/posts"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Maximum likelyhood estimation</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Probability&amp;Statistics</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>신호연 </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">December 29, 2022</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#problem-setting" id="toc-problem-setting" class="nav-link active" data-scroll-target="#problem-setting"><span style="color:#00994C"><strong>Problem Setting</strong></span></a></li>
  <li><a href="#what-is-estimation" id="toc-what-is-estimation" class="nav-link" data-scroll-target="#what-is-estimation"><span style="color : #00994C"> <strong>What is estimation?</strong> </span></a></li>
  <li><a href="#likelyhood-function" id="toc-likelyhood-function" class="nav-link" data-scroll-target="#likelyhood-function"><span style="color : #00994C"><strong>Likelyhood function</strong> </span></a></li>
  <li><a href="#mle최대가능도-추정법" id="toc-mle최대가능도-추정법" class="nav-link" data-scroll-target="#mle최대가능도-추정법"><span style="color : #00994C"><strong>MLE(최대가능도 추정법)</strong></span></a>
  <ul class="collapse">
  <li><a href="#예시" id="toc-예시" class="nav-link" data-scroll-target="#예시">예시</a></li>
  <li><a href="#ll" id="toc-ll" class="nav-link" data-scroll-target="#ll"><strong>LL</strong></a></li>
  <li><a href="#nll" id="toc-nll" class="nav-link" data-scroll-target="#nll"><strong>NLL</strong></a></li>
  </ul></li>
  <li><a href="#정리" id="toc-정리" class="nav-link" data-scroll-target="#정리"><span style="color : #00994C"><strong>정리</strong></span></a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p>최대가능도 추정법(MLE)에 대한 정리</p>
<section id="problem-setting" class="level2">
<h2 class="anchored" data-anchor-id="problem-setting"><span style="color:#00994C"><strong>Problem Setting</strong></span></h2>
<span class="math display">\[\begin{aligned}
&amp;\text{Given}\,x_1,x_2,...,x_N\ \text{which are realizations of a random sample }X_1,X_2,\dots,X_N \\
&amp;\text{where,}\, X_1 \sim f_1(x_1;\theta),X_2 \sim f_2(x_1;\theta),\dots,X_N \sim f_N(x_N;\theta) \\ \\

&amp;\text{Goal : 확률분포의 모수 $\theta$를 점추정하기}
\end{aligned}\]</span>
</section>
<section id="what-is-estimation" class="level2">
<h2 class="anchored" data-anchor-id="what-is-estimation"><span style="color : #00994C"> <strong>What is estimation?</strong> </span></h2>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="im">import</span> scipy <span class="im">as</span> sp</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4"></a>plt.style.use(<span class="st">"ggplot"</span>)</span>
<span id="cb1-5"><a href="#cb1-5"></a></span>
<span id="cb1-6"><a href="#cb1-6"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">5</span>))</span>
<span id="cb1-7"><a href="#cb1-7"></a>rv <span class="op">=</span> sp.stats.norm(<span class="dv">175</span>,<span class="dv">10</span>)</span>
<span id="cb1-8"><a href="#cb1-8"></a>x <span class="op">=</span> np.linspace(<span class="dv">150</span>,<span class="dv">200</span>,<span class="dv">500</span>)</span>
<span id="cb1-9"><a href="#cb1-9"></a>plt.plot(x,rv.pdf(x),<span class="st">"b"</span>)</span>
<span id="cb1-10"><a href="#cb1-10"></a>plt.title(<span class="st">"$N(175,10)$"</span>)</span>
<span id="cb1-11"><a href="#cb1-11"></a>plt.xlabel(<span class="st">"x"</span>)</span>
<span id="cb1-12"><a href="#cb1-12"></a>plt.ylabel(<span class="st">"y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Text(0, 0.5, 'y')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="MLE_files/figure-html/cell-2-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>대한민국 20대 남성들의 키가 다음과 확률분포를 따른다고 가정해보겠습니다. 우리는 “키가 175근처인 사람이 대부분이네??” 또는 “키가 160이하이거나 190이상인 사람은 거의 없겠네?” 등의 해석을 할 수 있습니다. 이러한 해석을 가능하게 하는것은 우리가 확률분포의 모양(정규분포)과 모수(평균,분산)을 가정했기 때문입니다. 극단적으로,같은 평균이라는 모수를 가지지만 전혀다른 분포인 베르누이분포라고 가정을 하면 확률변수의 값이 딱 떨어지는 2개의 이산적인 값만을 가지므로 “이하”라는 표현이나 “이상”이라는 표현은 쓸 수 없습니다.(물론 베르누이분포는 분산은 모수가 아니긴합니다.) 모양이 같지만 모수가 다른 경우도 마찬가지입니다. 같은 정규분포라도 평균이나 분산이 다르면 전혀 다른 해석이 가능합니다.<br></p>
<p>만약 위와 같은 해석을 하고싶으나 20대 남성들의 키가 따르는 분포자체를 모른다면 해야할까요? 위와 같은 해석을 하기위해서는 확률분포 더 상세히말하자면 확률분포의 모양과 확률분포의 모수를 알아야 합니다. 이를 확률분포의 추정이라고 합니다.<br></p>
<p>확률분포의 추정에서 보통 분포의 모양은 어떠한 분포로 가정합니다(ex 정규분포,베타분포,베르누이분포,다항분포 등등…). 그 다음은 확률분포의 모수를 추정해야 합니다. 이때 모수를 추정하는 방법 중 하나가 바로 최대가능도 추정법(Maximum likelihood estimation)입니다.<br></p>
<p>아까전 상황을 다시 생각해봅시다. 우리는 확률분포로부터 몇 가지의 해석을 할 수 있었습니다. 이는 확률분포의 모양과 모수(평균,분산)를 먼저 가정을 했기 때문이었고,이로부터 특정한 표본이 나올 수 있는 가능성을 알 수 있었습니다.이와는 반대로,최대가능도 추정법에서는 역으로 샘플이 주어져있다고 가정하고 가정한 확률분포의 모양에 대해서 가장 가능성이 높은 모수를 이 모수를 모수에 대한 추정량(estimated value)로 합니다.</p>
</section>
<section id="likelyhood-function" class="level2">
<h2 class="anchored" data-anchor-id="likelyhood-function"><span style="color : #00994C"><strong>Likelyhood function</strong> </span></h2>
<p>위에서 <strong>샘플이 주어져있다고 가정하고 가장 가능성이 높은 모수</strong>가 모수에 대한 추정량이라고 했습니다. 그렇다면 가능성이 가장 높은 모수를 정하기 위해서 <strong>모수의 가능성</strong>이라는 지표를 정의할 필요가 있습니다. 모수의 가능성은 어떻게 정의해야 할까요?</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a>rv1 <span class="op">=</span> sp.stats.norm(<span class="dv">175</span>,<span class="dv">10</span>)</span>
<span id="cb3-2"><a href="#cb3-2"></a>rv2 <span class="op">=</span> sp.stats.norm(<span class="dv">185</span>,<span class="dv">10</span>)</span>
<span id="cb3-3"><a href="#cb3-3"></a>rv3 <span class="op">=</span> sp.stats.norm(<span class="dv">160</span>,<span class="dv">10</span>)</span>
<span id="cb3-4"><a href="#cb3-4"></a>x <span class="op">=</span> np.linspace(<span class="dv">150</span>,<span class="dv">200</span>,<span class="dv">500</span>)</span>
<span id="cb3-5"><a href="#cb3-5"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">5</span>))</span>
<span id="cb3-6"><a href="#cb3-6"></a>plt.plot(x,rv1.pdf(x),<span class="st">"b"</span>)</span>
<span id="cb3-7"><a href="#cb3-7"></a>plt.plot(x,rv2.pdf(x),<span class="st">"g"</span>)</span>
<span id="cb3-8"><a href="#cb3-8"></a>plt.plot(x,rv3.pdf(x),<span class="st">"purple"</span>)</span>
<span id="cb3-9"><a href="#cb3-9"></a>plt.plot([<span class="dv">177</span>],[<span class="dv">0</span>],<span class="st">"o"</span>,color<span class="op">=</span><span class="st">"black"</span>,ms<span class="op">=</span><span class="st">"10"</span>)</span>
<span id="cb3-10"><a href="#cb3-10"></a>plt.plot </span>
<span id="cb3-11"><a href="#cb3-11"></a>plt.axvline(<span class="dv">177</span>,color <span class="op">=</span> <span class="st">"black"</span>,linewidth <span class="op">=</span> <span class="dv">1</span>,linestyle <span class="op">=</span> <span class="st">"--"</span>,ymin<span class="op">=</span><span class="fl">0.07</span>)</span>
<span id="cb3-12"><a href="#cb3-12"></a>plt.title(<span class="st">"Normal distributions"</span>)</span>
<span id="cb3-13"><a href="#cb3-13"></a>plt.xlabel(<span class="st">"x"</span>)</span>
<span id="cb3-14"><a href="#cb3-14"></a>plt.ylabel(<span class="st">"y"</span>)</span>
<span id="cb3-15"><a href="#cb3-15"></a>plt.legend([<span class="st">"$N(175,10)$"</span>,<span class="st">"$N(170,10)$"</span>,<span class="st">"$N(165,10)$"</span>],loc<span class="op">=</span><span class="st">"upper right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>&lt;matplotlib.legend.Legend at 0x21d4e82fb20&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="MLE_files/figure-html/cell-3-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>그림과 같이 크기가1인 표본을 177 얻었고 확률분포의 모양은 정규분포로 가정했다고 해봅시다. 샘플이 주어져 있을때 가능성이 가장 높은 모수는 무엇일까요? 그래프를 들여다보니 보라색 확률분포에서는 뭔가 표본을 얻기는 힘들 것 같습니다. 표본을 뽑을 확률(엄밀히는 확률밀도이지만 확률로 적겠습니다.)이 너무 낮아서 가능성이 너무 낮기 때문입니다. 초록색의 경우는 보라색보다는 확률이 더 크기때문에 가능성이 더 커보입니다. 파랑색의 경우는 확률이 초록색보다도 더 큽니다. 그러므로 3개의 분포중에서는 파랑색 확률분포의 모수인 175가 가능성이 가장 커보이고 이를 실제 모수에 대한 추정값으로 하는 것이 합리적입니다.<br></p>
<p>위의 예시에서 가능성을 확인하기 위해서 확률분포의 값(y축,확률,확률밀도)을 확인했습니다.결국 우리가 정의하기로 지표인 <strong>모수의 가능성</strong>은 결국은 <strong>확률(또는 확률밀도)</strong> 그 자체임을 알 수 있습니다. 그러나 확률과는 약간 다르게 확률(또는 확률밀도)은 모수를 가정하고 확률분포의 값을 읽는 반면 <strong>모수의 가능성</strong>은 샘플을 가정하고 모수를 바꿔가며 서로다른 확률분포에서 값을 파악함에 차이가 있습니다. 모수의 가능성에는 <strong>가능도(likelyhood)</strong>라는 이름을 붙여줍니다.</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a>rv1 <span class="op">=</span> sp.stats.norm(<span class="dv">175</span>,<span class="dv">10</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a>rv2 <span class="op">=</span> sp.stats.norm(<span class="dv">185</span>,<span class="dv">10</span>)</span>
<span id="cb5-3"><a href="#cb5-3"></a>rv3 <span class="op">=</span> sp.stats.norm(<span class="dv">160</span>,<span class="dv">10</span>)</span>
<span id="cb5-4"><a href="#cb5-4"></a>x <span class="op">=</span> np.linspace(<span class="dv">150</span>,<span class="dv">200</span>,<span class="dv">500</span>)</span>
<span id="cb5-5"><a href="#cb5-5"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">5</span>))</span>
<span id="cb5-6"><a href="#cb5-6"></a>plt.plot(x,rv1.pdf(x),<span class="st">"b"</span>)</span>
<span id="cb5-7"><a href="#cb5-7"></a>plt.plot(x,rv2.pdf(x),<span class="st">"g"</span>)</span>
<span id="cb5-8"><a href="#cb5-8"></a>plt.plot(x,rv3.pdf(x),<span class="st">"purple"</span>)</span>
<span id="cb5-9"><a href="#cb5-9"></a>s <span class="op">=</span> [<span class="dv">173</span>,<span class="dv">177</span>,<span class="dv">175</span>,<span class="dv">180</span>]</span>
<span id="cb5-10"><a href="#cb5-10"></a>plt.plot(s,[<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>],<span class="st">"o"</span>,color<span class="op">=</span><span class="st">"black"</span>,ms<span class="op">=</span><span class="st">"10"</span>)</span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="cf">for</span> i <span class="kw">in</span> s:</span>
<span id="cb5-12"><a href="#cb5-12"></a>    temp <span class="op">=</span> [i]</span>
<span id="cb5-13"><a href="#cb5-13"></a>    plt.axvline(temp,linestyle <span class="op">=</span> <span class="st">"--"</span>,color<span class="op">=</span><span class="st">"black"</span>,linewidth<span class="op">=</span><span class="dv">1</span>,ymin<span class="op">=</span><span class="fl">0.07</span>,ymax <span class="op">=</span> <span class="fl">0.96</span>)</span>
<span id="cb5-14"><a href="#cb5-14"></a>plt.title(<span class="st">"Normal distributions"</span>)</span>
<span id="cb5-15"><a href="#cb5-15"></a>plt.xlabel(<span class="st">"x"</span>)</span>
<span id="cb5-16"><a href="#cb5-16"></a>plt.ylabel(<span class="st">"y"</span>)</span>
<span id="cb5-17"><a href="#cb5-17"></a>plt.legend([<span class="st">"$N(175,10)$"</span>,<span class="st">"$N(170,10)$"</span>,<span class="st">"$N(165,10)$"</span>],loc<span class="op">=</span><span class="st">"upper right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>&lt;matplotlib.legend.Legend at 0x21d4e89d160&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="MLE_files/figure-html/cell-4-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>이번에는 크기가 4인 표본을 얻었다고 해봅시다. 분포의 모양은 마찬가지로 정규분포로 가정했습니다. 이번에는 샘플의 크기가4이므로 이전과는 다르게 하나의 데이터포인트만 반영하는 것이 아니라 4개의 데이터포인트를 모두 반영하여 가능성이 가장 높은 모수를 고려해야 합니다. <br></p>
<p>위에서 1개의 데이터포인트(표본)를 고려할때에는 여러가지 모수를 따르는 분포에서 1개의 확률값만 읽고 어떤 모수가 가능성이 가장 높은지 확인하고 가능도라는 것을 정의했습니다. 4개일때도 다르지 않습니다. 4개일때에도 확률값을 읽는데 다만 달라진 것은 4개의 확률값을 동시에 함께 반영해야 한다는 점입니다. 4개일 경우에는 4개의 표본 모두에 대하여 동시에 함께 그 가능성을 고려해야 합니다. 그러므로 여기서는 가능도인 확률을 각각의 데이터포인트를 뽑을 동시에 함께 뽑을 확률이자 확률의 곱인 확률인 결합확률(joint distribution)로 계산해야 합니다.</p>
<p><span style="font-size:15pt"><strong>정리</strong></span><br> 모수의 가능도는 샘플과 확률분포의 모양이 주어져있을 때,어떤 모수가 주어진 <strong>샘플을 취할 가능성</strong>을 의미하며 이는 곧 <strong>(결합)확률</strong> 입니다. 다만 확률(또는 확률분포)의 경우에는 목적이 모수가 정해진 확률분포로부터 읽는 그 값을 읽어 어떤 샘플 x값을 취할 가능성을 파악하는 것이고 반면 가능도는 샘플이 이미 뽑혀서 정해져있을때, 서로다른 모수를 가지는 확률분포의 값을 읽어서 어떤 모수가 가장 가능성이 높은지 파악하는 것입니다. 수학적으로 표기하면 다음과 같습니다.<br></p>
<p><span class="math display">\[\begin{align}
L(\theta|D) = L(\theta|x_1,x_2,\dots,x_N) &amp;= f_{X_1,X_2,\dots,X_N}(x_1,x_2,\dots,x_N;\theta) \\
&amp;= \prod_{i=1}^{N}f_{X_i}(x_i;\theta)
\end{align}\]</span></p>
<p>식(1)은 가능도 = 결합확률임을 의미합니다. 식(2)는 확률변수가 독립일 경우의 결합확률 = 확률의 곱입니다. 각각의 샘플에 대한 확률변수는 모두 독립이라고 가정합니다.</p>
</section>
<section id="mle최대가능도-추정법" class="level2">
<h2 class="anchored" data-anchor-id="mle최대가능도-추정법"><span style="color : #00994C"><strong>MLE(최대가능도 추정법)</strong></span></h2>
<p>최대가능도추정법(MLE)는 확률분포의 모수를 추정하는 점추정방법 중 하나로 가능도를 가장크게하는 모숫값을 모수에 대한 추정값 하는 방법입니다.다음과 같습니다.<br></p>
<span class="math display">\[\begin{aligned}
\hat{\theta}_{MLE} &amp;= \underset{\theta}{\text{argmax}}\,L(\theta|x_1,x_2 \dots x_n) \\
&amp;=  \underset{\theta}{\text{argmax}},f_{X_1,X_2,\dots,X_n}(x_1,x_2,\dots,x_n|\theta) \\
&amp;= \underset{\theta}{\text{argmax}}\,\prod_{i=1}^{N}f_{X_i}(x_i;\theta)
\end{aligned}\]</span>
<p><br></p>
<section id="예시" class="level3">
<h3 class="anchored" data-anchor-id="예시">예시</h3>
<p>대한민국 20대 남성들의 키의 분포가 정규분포를 따른다고 가정해보겠습니다. 샘플링하여 크기가 4인표본[173,177,175,180]을 얻은 상태입니다. 목적은 정규분포의 모수인 <span class="math inline">\(\mu\)</span>를 MLE로 추정하는 것입니다.<br></p>
<p>다음을 계산해야 합니다<br></p>
<span class="math display">\[\begin{aligned}
\underset{\theta}{\text{argmax }}L(\theta;x_1,x_2,x_3) &amp;= \prod_{i=1}^{4}f_{X_i}(x_i;\theta)\\
&amp;= \underset{\theta}{\text{argmax }}f_{X_1}(x_1;\theta)f_{X_2}(x_2;\theta)f_{X_2}(x_2;\theta)f_{X_2}(x_2;\theta)\\
&amp;= \underset{\theta}{\text{argmax }}\mathcal{N}(x_1;\mu,\sigma^2)\mathcal{N}(x_2;\mu,\sigma^2)\mathcal{N}(x_3;\mu,\sigma^2)\mathcal{N}(x_4;\mu,\sigma^2) \\
&amp;= \underset{\theta}{\text{argmax }}\frac{1}{\sqrt{2\pi\sigma^2}} \exp\left({-\frac{(173-\mu)^2}{2\sigma^2}}\right) \cdot \frac{1}{\sqrt{2\pi\sigma^2}} \exp\left({-\frac{(177-\mu)^2}{2\sigma^2}}\right) \\ \cdot &amp;\frac{1}{\sqrt{2\pi\sigma^2}} \exp\left({-\frac{(175-\mu)^2}{2\sigma^2}}\right) \cdot\frac{1}{\sqrt{2\pi\sigma^2}} \exp\left({-\frac{(178-\mu)^2}{2\sigma^2}}\right)\\
&amp;= \underset{\theta}{\text{argmax }}\frac{1}{\sqrt{2\pi\sigma^2}}\text{exp}(-\frac{(173-\mu)^2 + (177-\mu)^2 + (175-\mu)^2 + (178-\mu)^2}{\sigma^2})
\end{aligned}\]</span>
<p>위의 가능도 함수가 최대가 되려면 exp의 지수의 분자인 <span class="math inline">\(-[(173-\mu)^2 + (177-\mu)^2 + (175-\mu)^2 + (178-\mu)^2]\)</span>가 최대가 되면 됩니다.(분산은 고려하지 않겠습니다.)분자는 2차함수이므로 최대가 되는 지점을 구할 수 있습니다. 여기서는 넘파이를 활용하여 계산하겠습니다.</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">120</span>,<span class="dv">232</span>,<span class="dv">50000</span>)</span>
<span id="cb7-2"><a href="#cb7-2"></a>y <span class="op">=</span> <span class="op">-</span>((<span class="dv">173</span><span class="op">-</span>x)<span class="op">**</span><span class="dv">2</span> <span class="op">+</span>(<span class="dv">177</span><span class="op">-</span>x)<span class="op">**</span><span class="dv">2</span><span class="op">+</span>(<span class="dv">175</span><span class="op">-</span>x)<span class="op">**</span><span class="dv">2</span><span class="op">+</span>(<span class="dv">178</span><span class="op">-</span>x)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb7-3"><a href="#cb7-3"></a>max_idx <span class="op">=</span> np.where(y <span class="op">==</span> np.<span class="bu">max</span>(y))</span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="bu">print</span>(x[max_idx])</span>
<span id="cb7-5"><a href="#cb7-5"></a>plt.axvline(x[max_idx],color<span class="op">=</span><span class="st">"black"</span>,linestyle<span class="op">=</span><span class="st">"--"</span>)</span>
<span id="cb7-6"><a href="#cb7-6"></a>plt.plot(x,y,<span class="st">"b"</span>)</span>
<span id="cb7-7"><a href="#cb7-7"></a>plt.scatter(x[max_idx],y[max_idx],s<span class="op">=</span><span class="dv">100</span>,c<span class="op">=</span><span class="st">"black"</span>,marker<span class="op">=</span><span class="st">"s"</span>)</span>
<span id="cb7-8"><a href="#cb7-8"></a>plt.title(<span class="ss">f"max(y) = </span><span class="sc">{</span><span class="bu">round</span>(np.<span class="bu">max</span>(y),<span class="dv">3</span>)<span class="sc">}</span><span class="ss"> if $\mu$ = </span><span class="sc">{</span><span class="bu">round</span>(x[max_idx][<span class="dv">0</span>],<span class="dv">3</span>)<span class="sc">}</span><span class="ss">, "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[175.750235]</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>Text(0.5, 1.0, 'max(y) = -14.75 if $\\mu$ = 175.75, ')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="MLE_files/figure-html/cell-5-output-3.png" class="img-fluid"></p>
</div>
</div>
<p>가능도함수를 최대로 하는 모숫값은 175.75입니다. 따라서 MLE에 의한 모수에 대한 추정값은 175.75입니다.<br> <span class="math display">\[\hat{\theta}_{MLE} = 175.75\]</span></p>
</section>
<section id="ll" class="level3">
<h3 class="anchored" data-anchor-id="ll"><strong>LL</strong></h3>
<p>LL은 log likelyhood의 약자로 likelyhood에 log를 취해준 값입니다. 로그함수를 취해도 함수가 MLE의 계산결과(가능도가 최대인 모수에 대한 추정값)의 위치가 변하지 않고 계산을 곱셈을 더하기로 바꿔서 계산하기에 더 편리하기 때문에 LL을 사용할 수도 있습니다.<br> <span class="math display">\[LL = \text{ln }L(\theta|x_1,x_2 \dots,x_N)\]</span></p>
</section>
<section id="nll" class="level3">
<h3 class="anchored" data-anchor-id="nll"><strong>NLL</strong></h3>
<p>NLL은 LL에 -(negative)를 곱해준 값입니다. 함수가 최대인 지점을 찾는 문제를 최소인 지점을 찾는 문제로 바꿀 수 있습니다. <span class="math display">\[NLL = -\text{ln }L(\theta|x_1,X_2 = x_2 \dots x_N)\]</span></p>
</section>
</section>
<section id="정리" class="level1">
<h1><span style="color : #00994C"><strong>정리</strong></span></h1>
<p>MLE를 통해서 모수에 대한 추정량을 구하면 다음과 같습니다.</p>
<span class="math display">\[\begin{aligned}
\hat{\theta}_{MLE} &amp;= \underset{\theta}{\text{argmax}}\,L(\theta|x_1,x_2 \dots x_N)\\
&amp;= \underset{\theta}{\text{argmax}},f_{X_1,X_2,\dots,X_n}(x_1,x_2,\dots,x_n|\theta) \\
&amp;= \underset{\theta}{argmin}\,-\text{ln}\,L(\theta|x_1,x_2\dots x_N)
\end{aligned}\]</span>
<p><a href="https://stats.stackexchange.com/questions/239500/what-is-the-difference-between-random-variable-and-random-sample">링크1(random sample vs random variable)</a><br> <a href="https://m.blog.naver.com/PostView.naver?isHttpsRedirect=true&amp;blogId=soohwan2-&amp;logNo=100200023641">링크2(추정,추정량,추정값)</a><br> <a href="https://angeloyeo.github.io/2020/07/17/MLE.html">링크3(mle)</a><br> <a href="https://datascienceschool.net/02%20mathematics/09.02%20%EC%B5%9C%EB%8C%80%EA%B0%80%EB%8A%A5%EB%8F%84%20%EC%B6%94%EC%A0%95%EB%B2%95.html">링크4(mle)</a></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="hoyeon1234/sin-hoyeon" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->



</body></html>